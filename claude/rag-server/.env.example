# ========================================
# RAG MCP Server Environment Configuration
# ========================================

# ----------------------------------------
# Basic Configuration
# ----------------------------------------
NODE_ENV=development
DATA_DIR=./.data
DOCUMENTS_DIR=./documents
LOG_LEVEL=info

# ----------------------------------------
# Database
# ----------------------------------------
DATABASE_URL=file:./database.db

# ----------------------------------------
# Document Processing
# ----------------------------------------
CHUNK_SIZE=1024
CHUNK_OVERLAP=20
SIMILARITY_TOP_K=5
SIMILARITY_THRESHOLD=0.75

# ----------------------------------------
# Embedding Configuration
# ----------------------------------------
# Service: 'transformers' (local) or 'ollama' (external)
EMBEDDING_SERVICE=transformers

# Available transformers models:
# - all-MiniLM-L6-v2: 384 dims, fast, good for general use (batch: 20)
# - all-MiniLM-L12-v2: 384 dims, more accurate than L6 (batch: 15)
# - bge-small-en: 384 dims, high quality English embeddings (batch: 15)
# - bge-base-en: 768 dims, better quality, slower (batch: 10)
# - gte-multilingual-base: 768 dims, good multilingual support (batch: 10)
EMBEDDING_MODEL=gte-multilingual-base
EMBEDDING_DEVICE=cpu
EMBEDDING_BATCH_SIZE=10
TRANSFORMERS_CACHE_DIR=./.data/.cache/transformers

# Ollama Configuration (if using EMBEDDING_SERVICE=ollama)
# Available Ollama models:
# - nomic-embed-text: 768 dims, recommended general use
# - mxbai-embed-large: 1024 dims, high quality
# - snowflake-arctic-embed: 1024 dims, good performance
# - bge-large: 1024 dims, multilingual
OLLAMA_BASE_URL=http://localhost:11434
# EMBEDDING_MODEL=nomic-embed-text  # When using EMBEDDING_SERVICE=ollama

# ----------------------------------------
# Vector Store Configuration
# ----------------------------------------
# Provider: 'lancedb' (only supported provider)
VECTOR_STORE_PROVIDER=lancedb

# LanceDB Configuration
LANCEDB_URI=./.data/lancedb

# ----------------------------------------
# Processing Pipeline
# ----------------------------------------
MAX_CONCURRENT_PROCESSING=3
BATCH_SIZE=10
MAX_RETRIES=2
BASE_DELAY=1000
MAX_DELAY=5000

# ----------------------------------------
# Search Configuration
# ----------------------------------------
ENABLE_QUERY_REWRITING=false
ENABLE_RERANKING=false

# ----------------------------------------
# Model Migration
# ----------------------------------------
ENABLE_AUTO_MIGRATION=true
ENABLE_INCOMPATIBILITY_DETECTION=true
CLEAR_VECTORS_ON_MODEL_CHANGE=true
BACKUP_EMBEDDINGS_BEFORE_MIGRATION=false
MIGRATION_TIMEOUT=300000

# ----------------------------------------
# MCP Transport Configuration
# ----------------------------------------
# Transport: 'stdio' (default for development) or 'streamable-http'
MCP_TRANSPORT=stdio
MCP_PORT=3000
MCP_HOST=localhost
MCP_ENABLE_CORS=true
MCP_SESSION_TIMEOUT=300000
MCP_ALLOWED_ORIGINS=*
MCP_DNS_REBINDING_PROTECTION=false

# ----------------------------------------
# Performance and Timeout Configuration
# ----------------------------------------

# LanceDB Connection Timeouts
LANCEDB_CONNECT_TIMEOUT_MS=30000
LANCEDB_READ_TIMEOUT_MS=60000
LANCEDB_POOL_IDLE_TIMEOUT_MS=120000
LANCEDB_SEARCH_TIMEOUT_MS=30000

# MCP HTTP Server Timeouts
MCP_CONNECTION_TIMEOUT_MS=120000
MCP_KEEP_ALIVE_TIMEOUT_MS=65000
MCP_REQUEST_TIMEOUT_MS=90000

# Embedding and Search Timeouts
EMBEDDING_TIMEOUT_MS=15000
SEARCH_PIPELINE_TIMEOUT_MS=60000

# Embedding Cache Configuration
EMBEDDING_CACHE_ENABLED=true
EMBEDDING_CACHE_SIZE=100

# ----------------------------------------
# System Information (Optional)
# ----------------------------------------
# Used by logger for structured logging
# HOSTNAME=your-hostname
# npm_package_version=1.0.0